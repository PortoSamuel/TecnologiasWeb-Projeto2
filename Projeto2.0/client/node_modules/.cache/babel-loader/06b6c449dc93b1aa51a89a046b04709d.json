{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Samuel Porto\\\\Desktop\\\\Semestres\\\\4\\xB0 Semestre\\\\TechWeb\\\\Parte2\\\\Projeto2.0\\\\client\\\\src\\\\components\\\\FirstPage.js\";\nimport React, { Component } from 'react';\n\nvar SpotifyWebApi = require('spotify-web-api-node');\n\nvar spotifyApi = new SpotifyWebApi({\n  clientId: 'ec764db0ded7495dadb967725e9ced59',\n  clientSecret: '5830e377db754d328989ab9cb47f8562',\n  redirectUri: 'http://www.example.com/callback'\n});\n\nclass FirstPage extends Component {\n  constructor(props) {\n    super(props);\n    const params = this.getHashParams();\n    this.state = {\n      access_token: params.access_token,\n      user_image: '',\n      user_name: '',\n      total_pages: '',\n      user_musics: '',\n      page: 0\n    };\n    spotifyApi.setAccessToken(this.state.access_token);\n    this.getMe = this.getMe.bind(this);\n    this.getMe();\n    this.getSavedTracks = this.getSavedTracks.bind(this);\n    this.getSavedTracks(this.state.page);\n    this.nextPage = this.nextPage(this);\n    this.previousPage = this.previousPage(this);\n  }\n\n  getHashParams() {\n    var hashParams = {};\n    var e,\n        r = /([^&;=]+)=?([^&;]*)/g,\n        q = window.location.hash.substring(1);\n\n    while (e = r.exec(q)) {\n      hashParams[e[1]] = decodeURIComponent(e[2]);\n    }\n\n    return hashParams;\n  }\n\n  async getMe() {\n    await spotifyApi.getMe().then(data => {\n      // console.log('Some information about the authenticated user', data.body);\n      this.setState({\n        user_image: data.body.images[0].url,\n        user_name: data.body.display_name\n      });\n    }, err => {\n      console.log('Erro getMe!', err);\n    });\n  }\n\n  async getSavedTracks(pag) {\n    await spotifyApi.getMySavedTracks({\n      limit: 10,\n      offset: pag\n    }).then(data => {\n      console.log('Done!');\n      console.log(data);\n      this.setState({\n        total_pages: data.body.total,\n        user_musics: data.body.items\n      });\n    }, err => {\n      console.log('Something went wrong!', err);\n    });\n  }\n\n  nextPage() {\n    if (this.state.page === this.state.total_pages) {\n      console.log(this.state.page);\n      return;\n    } else {\n      console.log(this.state.page);\n      const pageNumber = this.state.page + 20;\n      this.setState({\n        page: pageNumber\n      });\n      console.log(this.state.page);\n      this.getSavedTracks(pageNumber);\n    }\n  }\n\n  previousPage() {\n    if (this.state.page === 0) return;\n    console.log(this.state.page);\n    const pageNumber = this.state.page - 20;\n    this.setState({\n      page: pageNumber\n    });\n    console.log(this.state.page);\n    this.getSavedTracks(pageNumber);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"FirstPage\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: this.state.user_image,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, \"Bem vindo \", this.state.user_name, \"!\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, \"Suas m\\xFAsicas salvas:\"), React.createElement(\"div\", {\n      className: \"music-list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, Object.entries(this.state.user_musics).map(([k, v]) => React.createElement(\"article\", {\n      key: v.track.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: v.track.album.images[1].url,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    })), React.createElement(\"a\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, v.track.name))))), React.createElement(\"div\", {\n      className: \"actions\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      disabled: this.state.page === 0,\n      onClick: this.previousPage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"Anterior\"), React.createElement(\"button\", {\n      disabled: this.state.page === this.state.total_pages,\n      onClick: this.nextPage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"Pr\\xF3ximo\")));\n  }\n\n}\n\n;\nexport default FirstPage;","map":{"version":3,"sources":["C:/Users/Samuel Porto/Desktop/Semestres/4° Semestre/TechWeb/Parte2/Projeto2.0/client/src/components/FirstPage.js"],"names":["React","Component","SpotifyWebApi","require","spotifyApi","clientId","clientSecret","redirectUri","FirstPage","constructor","props","params","getHashParams","state","access_token","user_image","user_name","total_pages","user_musics","page","setAccessToken","getMe","bind","getSavedTracks","nextPage","previousPage","hashParams","e","r","q","window","location","hash","substring","exec","decodeURIComponent","then","data","setState","body","images","url","display_name","err","console","log","pag","getMySavedTracks","limit","offset","total","items","pageNumber","render","Object","entries","map","k","v","track","id","album","name"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\n\r\nvar SpotifyWebApi = require('spotify-web-api-node');\r\n\r\nvar spotifyApi = new SpotifyWebApi({\r\n    clientId: 'ec764db0ded7495dadb967725e9ced59',\r\n    clientSecret: '5830e377db754d328989ab9cb47f8562',\r\n    redirectUri: 'http://www.example.com/callback'\r\n});\r\n\r\nclass FirstPage extends Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        const params = this.getHashParams();\r\n\r\n        this.state = {\r\n            access_token : params.access_token,\r\n            user_image: '',\r\n            user_name: '',\r\n            total_pages: '',\r\n            user_musics: '',\r\n            page: 0\r\n        };\r\n\r\n        spotifyApi.setAccessToken(this.state.access_token);\r\n        \r\n        this.getMe = this.getMe.bind(this);\r\n        this.getMe();\r\n\r\n        this.getSavedTracks = this.getSavedTracks.bind(this);\r\n        this.getSavedTracks(this.state.page);\r\n\r\n        this.nextPage = this.nextPage(this);\r\n        this.previousPage = this.previousPage(this);\r\n    }\r\n\r\n    getHashParams() {\r\n        var hashParams = {};\r\n        var e, r = /([^&;=]+)=?([^&;]*)/g,\r\n            q = window.location.hash.substring(1);\r\n        while (e = r.exec(q)) {\r\n            hashParams[e[1]] = decodeURIComponent(e[2]);\r\n        }\r\n        return hashParams;\r\n    }\r\n\r\n    async getMe() {\r\n        await spotifyApi.getMe()\r\n             .then( (data) => {\r\n                 // console.log('Some information about the authenticated user', data.body);\r\n                 this.setState({user_image:data.body.images[0].url, user_name:data.body.display_name});\r\n\r\n             }, (err)  => {\r\n                 console.log('Erro getMe!', err);\r\n             });\r\n     };\r\n\r\n     async getSavedTracks(pag) {\r\n        await spotifyApi.getMySavedTracks({\r\n            limit: 10,\r\n            offset: pag\r\n        })\r\n            .then((data) => {\r\n                console.log('Done!');\r\n                console.log(data);\r\n                this.setState({total_pages: data.body.total, user_musics: data.body.items});\r\n            }, (err) => {\r\n                console.log('Something went wrong!', err);\r\n            });\r\n    }\r\n\r\n    nextPage() {\r\n\r\n        if (this.state.page === this.state.total_pages){\r\n            console.log(this.state.page);\r\n            return\r\n        }\r\n        else{\r\n        console.log(this.state.page);\r\n\r\n        const pageNumber = this.state.page + 20;\r\n\r\n        this.setState({page: pageNumber})\r\n\r\n        console.log(this.state.page);\r\n\r\n        this.getSavedTracks(pageNumber);\r\n        }\r\n\r\n    };\r\n\r\n    previousPage() {\r\n        if (this.state.page === 0) return;\r\n\r\n        console.log(this.state.page);\r\n\r\n        const pageNumber = this.state.page - 20;\r\n\r\n        this.setState({page: pageNumber})\r\n\r\n        console.log(this.state.page);\r\n\r\n        this.getSavedTracks(pageNumber);\r\n    }\r\n\r\n    render(){\r\n        return(\r\n            <div className=\"FirstPage\">\r\n                <img src={this.state.user_image} ></img>\r\n                <p>Bem vindo {this.state.user_name}!</p>\r\n                <p></p>\r\n                <p>Suas músicas salvas:</p>\r\n\r\n                <div className='music-list'>\r\n                    {Object.entries(this.state.user_musics).map(([k, v]) => (\r\n                        <article key={v.track.id}>\r\n                            <p>\r\n                                <img src={v.track.album.images[1].url} ></img>\r\n                                {/* <button onClick={removeTrack(v.track.id)}>Remover Música</button> */}\r\n                            </p>\r\n                            <a><strong>{v.track.name}</strong></a>\r\n                        </article>\r\n                    ))}\r\n                </div>\r\n\r\n                <div className='actions'>\r\n                    <button  disabled={this.state.page === 0} onClick={this.previousPage}>Anterior</button>\r\n                    <button  disabled={this.state.page === this.state.total_pages}  onClick={this.nextPage}>Próximo</button>\r\n                </div>\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n};\r\n\r\nexport default FirstPage;"]},"metadata":{},"sourceType":"module"}